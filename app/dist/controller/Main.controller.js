sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageBox","sap/m/MessageToast","bpfsagentui/model/formatter"],function(e,o,t,r,s){"use strict";return e.extend("bpfsagentui.controller.Main",{formatter:s,onInit:function(){var e=new o({busy:false,fsFileUploaded:false,jouleFileUploaded:false,comparisonResult:null,fsFile:null,jouleFile:null});this.getView().setModel(e)},_getBaseUrl:function(){return window.location.origin},onFsFileChange:function(e){var o=e.getSource();var t=e.getParameter("files")[0];if(t){this.getView().getModel().setProperty("/fsFile",t);this.getView().getModel().setProperty("/fsFileUploaded",true);r.show("FS Document selected: "+t.name)}},onJouleFileChange:function(e){var o=e.getSource();var t=e.getParameter("files")[0];if(t){this.getView().getModel().setProperty("/jouleFile",t);this.getView().getModel().setProperty("/jouleFileUploaded",true);r.show("Joule Response selected: "+t.name)}},onCompare:function(){var e=this.getView().getModel();var o=e.getProperty("/fsFile");var s=e.getProperty("/jouleFile");if(!o||!s){t.error("Please upload both documents before comparing.");return}var l=this.byId("busyDialog");l.open();var a=new FormData;a.append("fsDocument",o);a.append("jouleResponse",s);var i=this._getBaseUrl();fetch(i+"/api/compare",{method:"POST",body:a}).then(e=>{if(!e.ok){throw new Error("Comparison failed: "+e.statusText)}return e.json()}).then(o=>{if(o.success){e.setProperty("/comparisonResult",o.comparison);r.show("AI-powered document comparison completed successfully!");setTimeout(()=>{var e=this.byId("resultsPanel");if(e){e.getDomRef().scrollIntoView({behavior:"smooth"})}},100)}else{throw new Error(o.error||"Comparison failed")}}).catch(e=>{console.error("Comparison error:",e);t.error("Failed to compare documents: "+e.message)}).finally(()=>{l.close()})},onClear:function(){var e=this.getView().getModel();this.byId("fsFileUploader").clear();this.byId("jouleFileUploader").clear();e.setProperty("/fsFileUploaded",false);e.setProperty("/jouleFileUploaded",false);e.setProperty("/comparisonResult",null);e.setProperty("/fsFile",null);e.setProperty("/jouleFile",null);r.show("Form cleared")}})});
//# sourceMappingURL=Main.controller.js.map